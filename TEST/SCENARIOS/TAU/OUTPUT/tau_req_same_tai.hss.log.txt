yang@yang:~/LIONEL/openair-cn/SCRIPTS$ ./run_hss --import-db ../TEST/SCENARIOS/TAU/tau_req_same_tai_unknown_ue.sql
setting import DB flag to: 1
OPENAIRCN_DIR   = /home/yang/LIONEL/openair-cn
Database "oai_db" dropped
HSS: oai_db creation succeeded
HSS: oai_db import succeeded
==== EURECOM OPENAIR-HSS vBranch: branch-internal-Gauthier-Lionel Abrev. Hash: 04c5a30 Date: Wed Jan 27 09:12:34 2016 +0100 ====
Please report any bug to: openaircn-user@lists.eurecom.fr

Parsing configuration file: /usr/local/etc/oai/hss.conf
Configuration
* Global:
	- File .............: /usr/local/etc/oai/hss.conf
* MYSQL:
	- Server ...........: 127.0.0.1
	- Database .........: oai_db
	- User .............: hssadmin
	- Password .........: *****
* FreeDiameter:
	- Conf file ........: /usr/lib/../etc/freeDiameter/hss_fd.conf
* Security:
	- Operator key......: 
	- Random      ......: false
/home/yang/LIONEL/openair-cn/OAI_HSS/db/db_connector.c:74: Initializing db layer
/home/yang/LIONEL/openair-cn/OAI_HSS/db/db_connector.c:108: Initializing db layer: DONE
Initializing s6a layer
01/28/16,09:55:18.742974  NOTI   libfdproto '1.2.0' initialized.
01/28/16,09:55:18.744158  NOTI   libgnutls '2.12.23' initialized.
01/28/16,09:55:18.744533   DBG   Core state: 0 -> 1
01/28/16,09:55:18.744548  NOTI   libfdcore '1.2.0' initialized.
01/28/16,09:55:18.746597   DBG   Generating fresh Diffie-Hellman parameters of size 1024 (this takes some time)... 
01/28/16,09:55:19.005849   DBG   Loading : /usr/lib/freeDiameter/acl_wl.fdx
01/28/16,09:55:19.006158  NOTI   Extension ACL_wl initialized with configuration: '/usr/lib/../etc/freeDiameter/acl.conf'
01/28/16,09:55:19.006173   DBG   Loading : /usr/lib/freeDiameter/dict_nas_mipv6.fdx
01/28/16,09:55:19.006237   DBG   Dictionary Extension 'MIPv6 NAS-to-HAAA Interaction' initialized
01/28/16,09:55:19.006249   DBG   Loading : /usr/lib/freeDiameter/dict_s6a.fdx
01/28/16,09:55:19.007091  NOTI   Dictionary Extension 'S6A from 3GPP standard v.10.5' initialized
01/28/16,09:55:19.007106  NOTI   All extensions loaded.
01/28/16,09:55:19.007128  NOTI   freeDiameter configuration:
01/28/16,09:55:19.007136  NOTI     Default trace level .... : +1
01/28/16,09:55:19.007142  NOTI     Configuration file ..... : /usr/lib/../etc/freeDiameter/hss_fd.conf
01/28/16,09:55:19.007148  NOTI     Diameter Identity ...... : yang.openair4G.eur (l:18)
01/28/16,09:55:19.007153  NOTI     Diameter Realm ......... : openair4G.eur (l:13)
01/28/16,09:55:19.007159  NOTI     Tc Timer ............... : 30
01/28/16,09:55:19.007165  NOTI     Tw Timer ............... : 30
01/28/16,09:55:19.007170  NOTI     Local port ............. : 3868
01/28/16,09:55:19.007176  NOTI     Local secure port ...... : 5658
01/28/16,09:55:19.007182  NOTI     Number of SCTP streams . : 3
01/28/16,09:55:19.007187  NOTI     Number of clients thr .. : 5
01/28/16,09:55:19.007192  NOTI     Number of app threads .. : 2
01/28/16,09:55:19.007198  NOTI     Local endpoints ........ : Default (use all available)
01/28/16,09:55:19.007204  NOTI     Local applications ..... : (none)
01/28/16,09:55:19.007209  NOTI     Flags : - IP ........... : Enabled
01/28/16,09:55:19.007215  NOTI             - IPv6 ......... : DISABLED
01/28/16,09:55:19.007220  NOTI             - Relay app .... : DISABLED
01/28/16,09:55:19.007226  NOTI             - TCP .......... : Enabled
01/28/16,09:55:19.007231  NOTI             - SCTP ......... : DISABLED
01/28/16,09:55:19.007237  NOTI             - Pref. proto .. : TCP
01/28/16,09:55:19.007243  NOTI             - TLS method ... : INBAND
01/28/16,09:55:19.007248  NOTI     TLS :   - Certificate .. : /usr/lib/../etc/freeDiameter/hss.cert.pem
01/28/16,09:55:19.007254  NOTI             - Private key .. : /usr/lib/../etc/freeDiameter/hss.key.pem
01/28/16,09:55:19.007260  NOTI             - CA (trust) ... : /usr/lib/../etc/freeDiameter/hss.cacert.pem (1 certs)
01/28/16,09:55:19.007266  NOTI             - CRL .......... : (none)
01/28/16,09:55:19.007271  NOTI             - Priority ..... : (default: 'NORMAL')
01/28/16,09:55:19.007277  NOTI             - DH bits ...... : 1024
01/28/16,09:55:19.007282  NOTI     Origin-State-Id ........ : 1453971318
01/28/16,09:55:19.007291  NOTI   Loaded extensions: '/usr/lib/freeDiameter/acl_wl.fdx'[/usr/lib/../etc/freeDiameter/acl.conf], loaded
01/28/16,09:55:19.007297  NOTI   Loaded extensions: '/usr/lib/freeDiameter/dict_nas_mipv6.fdx'[(no config file)], loaded
01/28/16,09:55:19.007303  NOTI   Loaded extensions: '/usr/lib/freeDiameter/dict_s6a.fdx'[(no config file)], loaded
01/28/16,09:55:19.007316   DBG   Core state: 1 -> 2
01/28/16,09:55:19.009033  NOTI   Local server address(es): 192.168.12.17{---L-}	192.168.14.17{---L-}	192.170.0.1{---L-}	192.170.1.1{---L-}
01/28/16,09:55:19.009076   DBG   Core state: 2 -> 3
01/28/16,09:55:19.009160   DBG   yang.openair4G.eur: Connecting...
01/28/16,09:55:19.009182   DBG   'STATE_CLOSED'	-> 'STATE_WAITCNXACK'	'yang.openair4G.eur'
Initializing s6a layer: DONE
01/28/16,09:55:19.009322   DBG   Prepared 1 sets of connection parameters to peer yang.openair4G.eur
01/28/16,09:55:19.009363   DBG   Connecting to TCP 127.0.1.1(3870)...
01/28/16,09:55:19.009622   DBG   yang.openair4G.eur: Connection established, {----} TCP,#9->127.0.1.1(3870)
01/28/16,09:55:19.009712   DBG   SENT to 'yang.openair4G.eur': 'Capabilities-Exchange-Request'0/257 f:R--- src:'(nil)' len:248 {C:264/l:26,C:296/l:21,C:278/l:12,C:257/l:14,C:257/l:14,C:257/l:14,C:257/l:14,C:266/l:12,C:269/l:20,C:267/l:12,C:299/l:12,C:260/l:32,C:265/l:12}
01/28/16,09:55:19.009761   DBG   'STATE_WAITCNXACK'	-> 'STATE_WAITCEA'	'yang.openair4G.eur'
01/28/16,09:55:19.010470   DBG   RCV from 'yang.openair4G.eur': (no model)0/257 f:---- src:'yang.openair4G.eur' len:248 {C:268/l:12,C:264/l:26,C:296/l:21,C:278/l:12,C:257/l:14,C:257/l:14,C:257/l:14,C:257/l:14,C:266/l:12,C:269/l:20,C:267/l:12,C:260/l:32,C:265/l:12}
01/28/16,09:55:19.010553  NOTI   Connected to 'yang.openair4G.eur' (TCP,soc#9), remote capabilities: 
01/28/16,09:55:19.010565  NOTI      'Capabilities-Exchange-Answer'
01/28/16,09:55:19.010571  NOTI        Version: 0x01
01/28/16,09:55:19.010577  NOTI        Length: 248
01/28/16,09:55:19.010582  NOTI        Flags: 0x00 (----)
01/28/16,09:55:19.010588  NOTI        Command Code: 257
01/28/16,09:55:19.010593  NOTI        ApplicationId: 0
01/28/16,09:55:19.010598  NOTI        Hop-by-Hop Identifier: 0x5926C773
01/28/16,09:55:19.010604  NOTI        End-to-End Identifier: 0x7764120D
01/28/16,09:55:19.010609  NOTI         {internal data}: src:yang.openair4G.eur(18) rwb:(nil) rt:2 cb:(nil),(nil)((nil)) qry:0x7f7588000a00 asso:0 sess:(nil)
01/28/16,09:55:19.010615  NOTI         AVP: 'Result-Code'(268) l=12 f=-M val='DIAMETER_SUCCESS' (2001 (0x7d1))
01/28/16,09:55:19.010620  NOTI         AVP: 'Origin-Host'(264) l=26 f=-M val="yang.openair4G.eur"
01/28/16,09:55:19.010626  NOTI         AVP: 'Origin-Realm'(296) l=21 f=-M val="openair4G.eur"
01/28/16,09:55:19.010631  NOTI         AVP: 'Origin-State-Id'(278) l=12 f=-M val=1453971312 (0x56a9d770)
01/28/16,09:55:19.010637  NOTI         AVP: 'Host-IP-Address'(257) l=14 f=-M val=192.168.12.17
01/28/16,09:55:19.010642  NOTI         AVP: 'Host-IP-Address'(257) l=14 f=-M val=192.168.14.17
01/28/16,09:55:19.010648  NOTI         AVP: 'Host-IP-Address'(257) l=14 f=-M val=192.170.0.1
01/28/16,09:55:19.010653  NOTI         AVP: 'Host-IP-Address'(257) l=14 f=-M val=192.170.1.1
01/28/16,09:55:19.010659  NOTI         AVP: 'Vendor-Id'(266) l=12 f=-M val=0 (0x0)
01/28/16,09:55:19.010664  NOTI         AVP: 'Product-Name'(269) l=20 f=-- val="freeDiameter"
01/28/16,09:55:19.010669  NOTI         AVP: 'Firmware-Revision'(267) l=12 f=-- val=10200 (0x27d8)
01/28/16,09:55:19.010675  NOTI         AVP: 'Vendor-Specific-Application-Id'(260) l=32 f=-M val=(grouped)
01/28/16,09:55:19.010681  NOTI            AVP: 'Auth-Application-Id'(258) l=12 f=-M val=16777251 (0x1000023)
01/28/16,09:55:19.010686  NOTI            AVP: 'Vendor-Id'(266) l=12 f=-M val=10415 (0x28af)
01/28/16,09:55:19.010692  NOTI         AVP: 'Supported-Vendor-Id'(265) l=12 f=-M val=10415 (0x28af)
01/28/16,09:55:19.010701  NOTI   No TLS protection negotiated with peer 'yang.openair4G.eur'.
01/28/16,09:55:19.010718  NOTI   'STATE_WAITCEA'	-> 'STATE_OPEN'	'yang.openair4G.eur'
01/28/16,09:55:47.050443   DBG   SENT to 'yang.openair4G.eur': 'Device-Watchdog-Request'0/280 f:R--- src:'(nil)' len:84 {C:264/l:26,C:296/l:21,C:278/l:12}
01/28/16,09:55:47.051050   DBG   RCV from 'yang.openair4G.eur': (no model)0/280 f:---- src:'yang.openair4G.eur' len:96 {C:268/l:12,C:264/l:26,C:296/l:21,C:278/l:12}
01/28/16,09:55:56.331289   DBG   RCV from 'yang.openair4G.eur': (no model)16777251/318 f:RP-- src:'yang.openair4G.eur' len:268 {C:263/l:46,C:277/l:12,C:264/l:26,C:296/l:21,C:293/l:26,C:283/l:21,C:1/l:23,V:10415/C:1407/l:15,V:10415/C:1408/l:44}
01/28/16,09:55:56.331420   DBG   DISPATCHING: (no model)16777251/318 f:RP-- src:'yang.openair4G.eur' len:268 {C:263/l:46,C:277/l:12,C:264/l:26,C:296/l:21,C:293/l:26,C:283/l:21,C:1/l:23,V:10415/C:1407/l:15,V:10415/C:1408/l:44,C:282/l:8}
Converted 02f859 to plmn 208.95
/home/yang/LIONEL/openair-cn/OAI_HSS/db/db_connector.c:520: Query: SELECT `key`,`sqn`,`rand`,`OPc` FROM `users` WHERE `users`.`imsi`=208950000000002 
Key: 8b.af.47.3f.2f.8f.d0.94.87.cc.cb.d7.09.7c.68.62.
Received SQN 00000000000000018999 converted to 18999
SQN: 00.00.00.00.4a.37.
RAND: 00.00.00.00.00.00.00.00.00.00.00.00.00.00.00.00.
OPc: 8e.27.b6.af.0e.69.2e.75.0f.32.66.7a.3b.14.60.5d.
/home/yang/LIONEL/openair-cn/OAI_HSS/db/db_connector.c:390: Query: UPDATE `users` SET `rand`=UNHEX('00000000000000000000000000000000'),`sqn`=18999 WHERE `users`.`imsi`='208950000000002'
/home/yang/LIONEL/openair-cn/OAI_HSS/db/db_connector.c:416: 0 rows affected
/home/yang/LIONEL/openair-cn/OAI_HSS/db/db_connector.c:456: Query: UPDATE `users` SET `sqn` = `sqn` + 32 WHERE `users`.`imsi`=208950000000002
/home/yang/LIONEL/openair-cn/OAI_HSS/db/db_connector.c:481: 1 rows affected
RijndaelKeySchedule: K 8BAF473F2F8FD09487CCCBD7097C6862
MAC_A   : 55.50.8e.85.d6.b1.cc.fc.
SQN     : 00.00.00.00.4a.37.
RAND    : 00.00.00.00.00.00.00.00.00.00.00.00.00.00.00.00.
RijndaelKeySchedule: K 8BAF473F2F8FD09487CCCBD7097C6862
AK      : ad.bd.2f.5d.b3.43.
CK      : 97.9b.40.9a.fb.3d.d9.ad.59.3e.f0.82.6b.ab.a0.fb.
IK      : 0b.c2.9b.8d.7a.0a.38.c5.01.f1.0c.96.26.e1.a6.2f.
XRES    : 14.3b.ad.54.7b.85.52.9e.
AUTN    : ad.bd.2f.5d.f9.74.80.00.55.50.8e.85.d6.b1.cc.fc.
0x97 0x9b 0x40 0x9a 0xfb 0x3d 0xd9 0xad 0x59 0x3e 0xf0 0x82 0x6b 0xab 0xa0 0xfb 0x0b 0xc2 0x9b 0x8d 0x7a 0x0a 0x38 0xc5 0x01 0xf1 0x0c 0x96 0x26 0xe1 0xa6 0x2f 
0x10 0x02 0xf8 0x59 0x00 0x03 0xad 0xbd 0x2f 0x5d 0xf9 0x74 0x00 0x06 
KASME   : ec.91.5d.7b.a9.1c.a6.ad.34.54.46.af.19.5c.e1.e0.d6.16.51.c6.c1.8d.fa.22.fe.f9.c0.b6.02.1d.7d.66.
01/28/16,09:55:56.333045   DBG   SENT to 'yang.openair4G.eur': 'Authentication-Information-Answer'16777251/318 f:-P-- src:'(nil)' len:288 {C:263/l:46,V:10415/C:1413/l:144,C:277/l:12,C:264/l:26,C:296/l:21,C:268/l:12}
01/28/16,09:55:56.523086   DBG   RCV from 'yang.openair4G.eur': (no model)16777251/316 f:RP-- src:'yang.openair4G.eur' len:256 {C:263/l:46,C:277/l:12,C:264/l:26,C:296/l:21,C:293/l:26,C:283/l:21,C:1/l:23,V:10415/C:1407/l:15,V:10415/C:1032/l:16,V:10415/C:1405/l:16}
01/28/16,09:55:56.523215   DBG   DISPATCHING: (no model)16777251/316 f:RP-- src:'yang.openair4G.eur' len:256 {C:263/l:46,C:277/l:12,C:264/l:26,C:296/l:21,C:293/l:26,C:283/l:21,C:1/l:23,V:10415/C:1407/l:15,V:10415/C:1032/l:16,V:10415/C:1405/l:16,C:282/l:8}
Received new update location request
/home/yang/LIONEL/openair-cn/OAI_HSS/db/db_connector.c:139: Query: SELECT `access_restriction`,`mmeidentity_idmmeidentity`,`msisdn`,`ue_ambr_ul`,`ue_ambr_dl`,`rau_tau_timer` FROM `users` WHERE `users`.`imsi`='208950000000002' 
/home/yang/LIONEL/openair-cn/OAI_HSS/db/db_epc_equipment.c:51: Query: SELECT mmehost,mmerealm FROM mmeidentity WHERE mmeidentity.idmmeidentity='2' 
/home/yang/LIONEL/openair-cn/OAI_HSS/db/db_connector.c:314: Query: INSERT INTO `mmeidentity` (`mmehost`,`mmerealm`) SELECT 'yang.openair4G.eur','openair4G.eur' FROM `mmeidentity` WHERE NOT EXISTS (SELECT * FROM `mmeidentity` WHERE `mmehost`='yang.openair4G.eur' AND `mmerealm`='openair4G.eur') LIMIT 1;UPDATE `users`,`mmeidentity` SET `users`.`mmeidentity_idmmeidentity`=`mmeidentity`.`idmmeidentity`, `users`.`ms_ps_status`="NOT_PURGED" WHERE `users`.`imsi`='208950000000002' AND `mmeidentity`.`mmehost`='yang.openair4G.eur' AND `mmeidentity`.`mmerealm`='openair4G.eur'
/home/yang/LIONEL/openair-cn/OAI_HSS/db/db_connector.c:340: 0 rows affected
/home/yang/LIONEL/openair-cn/OAI_HSS/db/db_connector.c:340: 0 rows affected
Query: SELECT * FROM `pdn` WHERE `pdn`.`users_imsi`=208950000000002 LIMIT 10; 
01/28/16,09:55:56.524743   DBG   SENT to 'yang.openair4G.eur': 'Update-Location-Answer'16777251/316 f:-P-- src:'(nil)' len:544 {C:263/l:46,V:10415/C:1406/l:16,V:10415/C:1400/l:384,C:277/l:12,C:264/l:26,C:296/l:21,C:268/l:12}
01/28/16,09:56:26.627931   DBG   RCV from 'yang.openair4G.eur': (no model)0/280 f:R--- src:'yang.openair4G.eur' len:84 {C:264/l:26,C:296/l:21,C:278/l:12}
01/28/16,09:56:26.628110   DBG   SENT to 'yang.openair4G.eur': 'Device-Watchdog-Answer'0/280 f:---- src:'(nil)' len:96 {C:268/l:12,C:264/l:26,C:296/l:21,C:278/l:12}
01/28/16,09:56:54.733908   DBG   SENT to 'yang.openair4G.eur': 'Device-Watchdog-Request'0/280 f:R--- src:'(nil)' len:84 {C:264/l:26,C:296/l:21,C:278/l:12}
01/28/16,09:56:54.734537   DBG   RCV from 'yang.openair4G.eur': (no model)0/280 f:---- src:'yang.openair4G.eur' len:96 {C:268/l:12,C:264/l:26,C:296/l:21,C:278/l:12}
01/28/16,09:57:23.275113   DBG   RCV f
